[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Genetic Data Analysis ‚Äì Spring 2026",
    "section": "",
    "text": "Welcome to Genetic Data Analysis (CSES 7160) at Auburn University.\nThis course covers statistical and computational foundations for analyzing genetic, genomic, and phenotypic data in crop science, with an emphasis on reproducible workflows using R, Quarto, GitHub, and modern mixed-model approaches.\n\nKey Links\n\nSyllabus: See Shared Google Doc (or Canvas page)\nSchedule: See Shared Google Doc (or Canvas page)\nLecture Notes: See Shared Google Doc (or Canvas page)\nCourse GitHub Repo: \n\n\n\nInstructor\nDr.¬†Marnin D. Wolfe\nAssistant Professor, Quantitative Genetics\nDepartment of Crop, Soil & Environmental Sciences, Auburn University\n\n\nLessons\n\nLesson 1 - Reproducible data projects\nLesson 2 - Linear Models with Matrices",
    "crumbs": [
      "Home"
    ]
  },
  {
    "objectID": "lessons/2_LinearModels.html",
    "href": "lessons/2_LinearModels.html",
    "title": "Linear Models with Matrices",
    "section": "",
    "text": "Previously: Reproducible Projects in R",
    "crumbs": [
      "Module 1",
      "Linear Models with Matrices"
    ]
  },
  {
    "objectID": "lessons/1_Quarto.html",
    "href": "lessons/1_Quarto.html",
    "title": "Reproducible Projects in R",
    "section": "",
    "text": "First steps:\n\nDownload and install R: CRAN = the Comprehensive R Archive Network\nDownload and install Rstudio: https://posit.co/download/rstudio-desktop/\n\nRstudio = an interactive development environment (IDE) or ‚Äúfront end‚Äù, R comes with it‚Äôs own, but this one is better!\n\nInstall the tidyverse: an ‚Äúopinionated collection of R packages designed for data science‚Äù\n\n\n# I'll demo multiple ways to do this, starting with\ninstall.packages(\"tidyverse\")\n\n\nIf you need a crash course in R, there are lot‚Äôs of places to start. Here are some suggestions:\n\nR for Data Science (https://r4ds.had.co.nz/):\nAs the Rstudio / Tidyverse team recommends here (https://www.tidyverse.org/learn/), this book is ‚Äúthe best place to start learning the tidyverse‚Äù. Just about anyone should be able to (1) read the brief introduction and (2) look over the table of contents and quickly find a starting point that meets their level / interest.¬†\nRStartHere (https://github.com/rstudio/RStartHere).\nThis is basically a list or compendium of functions/packages in R with the uniquely useful feature of being organized according to the ‚ÄúData Science Workflow‚Äù presented in R for Data Science (https://r4ds.had.co.nz/explore-intro.html).",
    "crumbs": [
      "Module 1",
      "Reproducible Projects in R"
    ]
  },
  {
    "objectID": "lessons/1_Quarto.html#create-a-quarto-project",
    "href": "lessons/1_Quarto.html#create-a-quarto-project",
    "title": "Reproducible Projects in R",
    "section": "Create a Quarto Project",
    "text": "Create a Quarto Project\nTo start things off, let‚Äôs everyone create a new project within which to work/learn.\n\nRstudio &gt; File &gt; New Quarto Project &gt; New Directory &gt; ‚ÄúNew Project Wizard‚Äù opens\n\nProject Wizard:\n\nSpecify a name and path to the project\nNOTICE: ‚ÄúQuarto Website‚Äù option provides",
    "crumbs": [
      "Module 1",
      "Reproducible Projects in R"
    ]
  },
  {
    "objectID": "lessons/1_Quarto.html#how-it-works",
    "href": "lessons/1_Quarto.html#how-it-works",
    "title": "Reproducible Projects in R",
    "section": "How it works",
    "text": "How it works\nLet me show you how you can use Quarto.\n\n\nOpen the .qmd file created with same name as the project\n\nWhen you‚Äôve got multiple files open, Rstudio can store this information when you close\nYou can double click the ‚Äú.Rproj‚Äù to open the project in the state you left it!\n\n\n\nYAML\n\nThe file starts with a yaml ‚Äúheader‚Äù between two ‚Äú‚Äî‚Äù\n\nDefines format, behavior, rendered appearance\nAlso defines things like:\n\ntitle\nauthor\nformat\neditor\n\n\nThere is also a project-wide yaml file _quarto.yml.\n\nYou can control overall format and behavior with it.\nIt‚Äôs also where you can build out a Navigation bar if you have multiple linked pages in your project.\n\n\n\n---\nproject:\n  title: \"linear_models_intro\"\n\neditor: visual\n\nformat:\n  html:\n    toc: true\n    embed-resources: true\n    self-contained-math: true\n---\n\n\n\nMarkdown\nFor the authoritative documentation: https://quarto.org/docs/authoring/markdown-basics.html\n\nFormatting text\n\nHeadings using (e.g.¬†#, ##, ###)\n\nDifferent from ‚ÄúCOMMENTING‚Äù out code lines\n\nBolds (with **) and italics (*).\nLaTeX math\n\n\n\n\nLaTeX math\n\nInline with ($)\nFull display on own line with ($$)\n\nA superscript with (^), and underscore with (_)\nExample \\sigma^2_e renders as \\(\\sigma^2_e\\)\nYou can do more complicated super/subscripts, like so:\nx_{a^{b-c}} becomes \\[x_{a^{b-c}}\\]\nWhile \\frac{cov(x,y)}{var(x)} = \\hat{\\beta} renders as\n\\[\n\\frac{cov(x,y)}{var(x)} = \\hat{\\beta}\n\\]\nAnd much more.\nThere are plug-ins for Word and Google Docs that can read/render LaTeX equations.\n\n\nCode chunks\nIn your .qmd file, type Cmd + Option + I (Mac) or Ctrl + Alt + I (Win).\nShould create a ‚Äúcode chunk‚Äù, like this:\n```{r}\n# code here\n```\n\nNote the ‚ÄúPlay‚Äù and other config. buttons\n\n\n\nRendering\n\nSave and press the ‚ÄúRender‚Äù button\n\nNOTE on Rendering Quarto Markdown: Rendering runs all code chunks. If you have a long-running, resource intensive project, structure it to avoid running that part during render. Use ‚Äú````{r, eval=FALSE}`‚Äù.",
    "crumbs": [
      "Module 1",
      "Reproducible Projects in R"
    ]
  },
  {
    "objectID": "lessons/1_Quarto.html#visual-vs.-source-editor",
    "href": "lessons/1_Quarto.html#visual-vs.-source-editor",
    "title": "Reproducible Projects in R",
    "section": "Visual vs.¬†Source Editor",
    "text": "Visual vs.¬†Source Editor\n\nAt the top left. Two options.\nOther navigation pro-tips\n\nThe ‚ÄúOutline‚Äù tab in the Editor (top right)\n\nCode folding",
    "crumbs": [
      "Module 1",
      "Reproducible Projects in R"
    ]
  },
  {
    "objectID": "lessons/1_Quarto.html#objects-and-data-structures",
    "href": "lessons/1_Quarto.html#objects-and-data-structures",
    "title": "Reproducible Projects in R",
    "section": "Objects and data structures",
    "text": "Objects and data structures\n\n\n\n\n\n\nFigure¬†1: R Data structures ‚Äì figure from https://www.dataquest.io/\n\n\n\n\nVectors\n\n# Atomic vectors\nx = c(1,2,3,4,5,6) # numerical vector\nx1 = c(1.2, 1.3,1.8, 2.9, 10.5,0.9) # numerical vectors\ny &lt;- c(\"A\", \"B\", \"A\") # character vector\nz = c(TRUE, TRUE, FALSE, FALSE) # logical vector\n\ndim(x)\n\nNULL\n\nas.matrix(x)\n\n     [,1]\n[1,]    1\n[2,]    2\n[3,]    3\n[4,]    4\n[5,]    5\n[6,]    6\n\ndim(as.matrix(x))\n\n[1] 6 1\n\n\nVectors may only have one type.\n\n\nMatrices\n\n# Matrix: vectors in more than one dimension \nX &lt;- matrix(c(1, 0,\n              1, 1,\n              1, 0), nrow = 3, byrow = TRUE)\n\nX\n\n     [,1] [,2]\n[1,]    1    0\n[2,]    1    1\n[3,]    1    0\n\ndim(X)\n\n[1] 3 2\n\n\nMatrices can also only have one type or the other (char, num, logi).\n\n\ndata.frames\n\ndf &lt;- data.frame(y = c(10, 12, 11),\n                 geno = factor(c(\"G1\", \"G2\", \"G1\")),\n                 block = factor(c(1, 1, 2)))\nstr(df)\n\n'data.frame':   3 obs. of  3 variables:\n $ y    : num  10 12 11\n $ geno : Factor w/ 2 levels \"G1\",\"G2\": 1 2 1\n $ block: Factor w/ 2 levels \"1\",\"2\": 1 1 2\n\n\n\nColumns = variables\nRows = observations\nmixed variable types\nTechnically, a special case of a list\n\n\n# Example in Genomics\nx = c(\"snp1\",\"snp2\", \"snp3\", \"snp4\", \"snp5\", \"snp6\")\ny = c(1,1,2,2,3,3)\nz = c(10,20,100,400,150,200)\nind1 = c(\"AA\", \"AA\", \"aa\", \"Aa\", \"aa\", \"AA\")\nind2 = c(\"AA\", \"AA\", \"aa\", \"Aa\", \"AA\", \"AA\")\nind3 = c(\"Aa\", \"AA\", \"aa\", \"Aa\", \"Aa\", \"aa\")\nind4 = c(\"aa\", \"AA\", \"Aa\", \"aa\", \"AA\", \"AA\")\n\nsnp_data = data.frame(name = x,chr = y,pos = z,ind1,ind2,ind3,ind4)\nsnp_data\n\n  name chr pos ind1 ind2 ind3 ind4\n1 snp1   1  10   AA   AA   Aa   aa\n2 snp2   1  20   AA   AA   AA   AA\n3 snp3   2 100   aa   aa   aa   Aa\n4 snp4   2 400   Aa   Aa   Aa   aa\n5 snp5   3 150   aa   AA   Aa   AA\n6 snp6   3 200   AA   AA   aa   AA\n\n\n\n\nFactors\n\nlevels(df$geno)\n\n[1] \"G1\" \"G2\"\n\n\nFactors add a layer of information (an attribute) called levels().\nUse them ONLY for specific purposes to avoid undesired behavior.\nTwo examples (demo later):\n\nFactor levels matter for design matrix creation. They control the ordering of columns in a model.matrix() call.\nFactor levels control the order of appearance of categories in a plot made with ggplot(). ### Lists\n\nContainers for anything. Mix any type.\n\nm &lt;- lm(y ~ geno + block, data = df)\nstr(m)\n\nList of 13\n $ coefficients : Named num [1:3] 10 2 1\n  ..- attr(*, \"names\")= chr [1:3] \"(Intercept)\" \"genoG2\" \"block2\"\n $ residuals    : Named num [1:3] 0 0 0\n  ..- attr(*, \"names\")= chr [1:3] \"1\" \"2\" \"3\"\n $ effects      : Named num [1:3] -19.053 -1.225 0.707\n  ..- attr(*, \"names\")= chr [1:3] \"(Intercept)\" \"genoG2\" \"block2\"\n $ rank         : int 3\n $ fitted.values: Named num [1:3] 10 12 11\n  ..- attr(*, \"names\")= chr [1:3] \"1\" \"2\" \"3\"\n $ assign       : int [1:3] 0 1 2\n $ qr           :List of 5\n  ..$ qr   : num [1:3, 1:3] -1.732 0.577 0.577 -0.577 -0.816 ...\n  .. ..- attr(*, \"dimnames\")=List of 2\n  .. .. ..$ : chr [1:3] \"1\" \"2\" \"3\"\n  .. .. ..$ : chr [1:3] \"(Intercept)\" \"genoG2\" \"block2\"\n  .. ..- attr(*, \"assign\")= int [1:3] 0 1 2\n  .. ..- attr(*, \"contrasts\")=List of 2\n  .. .. ..$ geno : chr \"contr.treatment\"\n  .. .. ..$ block: chr \"contr.treatment\"\n  ..$ qraux: num [1:3] 1.577 1.966 0.707\n  ..$ pivot: int [1:3] 1 2 3\n  ..$ tol  : num 1e-07\n  ..$ rank : int 3\n  ..- attr(*, \"class\")= chr \"qr\"\n $ df.residual  : int 0\n $ contrasts    :List of 2\n  ..$ geno : chr \"contr.treatment\"\n  ..$ block: chr \"contr.treatment\"\n $ xlevels      :List of 2\n  ..$ geno : chr [1:2] \"G1\" \"G2\"\n  ..$ block: chr [1:2] \"1\" \"2\"\n $ call         : language lm(formula = y ~ geno + block, data = df)\n $ terms        :Classes 'terms', 'formula'  language y ~ geno + block\n  .. ..- attr(*, \"variables\")= language list(y, geno, block)\n  .. ..- attr(*, \"factors\")= int [1:3, 1:2] 0 1 0 0 0 1\n  .. .. ..- attr(*, \"dimnames\")=List of 2\n  .. .. .. ..$ : chr [1:3] \"y\" \"geno\" \"block\"\n  .. .. .. ..$ : chr [1:2] \"geno\" \"block\"\n  .. ..- attr(*, \"term.labels\")= chr [1:2] \"geno\" \"block\"\n  .. ..- attr(*, \"order\")= int [1:2] 1 1\n  .. ..- attr(*, \"intercept\")= int 1\n  .. ..- attr(*, \"response\")= int 1\n  .. ..- attr(*, \".Environment\")=&lt;environment: R_GlobalEnv&gt; \n  .. ..- attr(*, \"predvars\")= language list(y, geno, block)\n  .. ..- attr(*, \"dataClasses\")= Named chr [1:3] \"numeric\" \"factor\" \"factor\"\n  .. .. ..- attr(*, \"names\")= chr [1:3] \"y\" \"geno\" \"block\"\n $ model        :'data.frame':  3 obs. of  3 variables:\n  ..$ y    : num [1:3] 10 12 11\n  ..$ geno : Factor w/ 2 levels \"G1\",\"G2\": 1 2 1\n  ..$ block: Factor w/ 2 levels \"1\",\"2\": 1 1 2\n  ..- attr(*, \"terms\")=Classes 'terms', 'formula'  language y ~ geno + block\n  .. .. ..- attr(*, \"variables\")= language list(y, geno, block)\n  .. .. ..- attr(*, \"factors\")= int [1:3, 1:2] 0 1 0 0 0 1\n  .. .. .. ..- attr(*, \"dimnames\")=List of 2\n  .. .. .. .. ..$ : chr [1:3] \"y\" \"geno\" \"block\"\n  .. .. .. .. ..$ : chr [1:2] \"geno\" \"block\"\n  .. .. ..- attr(*, \"term.labels\")= chr [1:2] \"geno\" \"block\"\n  .. .. ..- attr(*, \"order\")= int [1:2] 1 1\n  .. .. ..- attr(*, \"intercept\")= int 1\n  .. .. ..- attr(*, \"response\")= int 1\n  .. .. ..- attr(*, \".Environment\")=&lt;environment: R_GlobalEnv&gt; \n  .. .. ..- attr(*, \"predvars\")= language list(y, geno, block)\n  .. .. ..- attr(*, \"dataClasses\")= Named chr [1:3] \"numeric\" \"factor\" \"factor\"\n  .. .. .. ..- attr(*, \"names\")= chr [1:3] \"y\" \"geno\" \"block\"\n - attr(*, \"class\")= chr \"lm\"",
    "crumbs": [
      "Module 1",
      "Reproducible Projects in R"
    ]
  },
  {
    "objectID": "lessons/1_Quarto.html#base-r",
    "href": "lessons/1_Quarto.html#base-r",
    "title": "Reproducible Projects in R",
    "section": "Base R",
    "text": "Base R\nVectors\n\ny[1]\n\n[1] 1\n\nz[2:3]\n\n[1]  20 100\n\nz[-c(1:5)]\n\n[1] 200\n\n\nMatrices\nmatrix[row,column]\n\nX[1:2,]\n\n     [,1] [,2]\n[1,]    1    0\n[2,]    1    1\n\n\ndata.frames\n\ndf[1,2]\n\n[1] G1\nLevels: G1 G2\n\ndf$geno\n\n[1] G1 G2 G1\nLevels: G1 G2\n\ndf[[\"geno\"]]\n\n[1] G1 G2 G1\nLevels: G1 G2\n\ndf[[\"geno\"]][1]\n\n[1] G1\nLevels: G1 G2\n\n\nLists\n\nm$coefficients\n\n(Intercept)      genoG2      block2 \n         10           2           1 \n\nm[1:2]\n\n$coefficients\n(Intercept)      genoG2      block2 \n         10           2           1 \n\n$residuals\n1 2 3 \n0 0 0 \n\nm[1:2][[\"residuals\"]]\n\n1 2 3 \n0 0 0 \n\nm[1:2][[\"residuals\"]][1]\n\n1 \n0",
    "crumbs": [
      "Module 1",
      "Reproducible Projects in R"
    ]
  },
  {
    "objectID": "lessons/1_Quarto.html#tidyverse-style---dplyr",
    "href": "lessons/1_Quarto.html#tidyverse-style---dplyr",
    "title": "Reproducible Projects in R",
    "section": "tidyverse style - dplyr + %>%",
    "text": "tidyverse style - dplyr + %&gt;%\nLet‚Äôs add to the tool set.\nThe ‚Äútidyverse‚Äù series of package provides a huge amount of utility for clear, human-readable programming. You‚Äôll learn it well following ‚ÄúR for Data Science‚Äù.\n\nlibrary(tidyverse)\n\nWarning: package 'ggplot2' was built under R version 4.5.2\n\n\nWarning: package 'readr' was built under R version 4.5.2\n\n\nFirst magrittr‚Äôs ‚Äúpipe‚Äù function (%&gt;%).\n\n\n\nx %&gt;% f is equivalent to f(x)\nx %&gt;% f(y) is equivalent to f(x, y)\nx %&gt;% f %&gt;% g %&gt;% h is equivalent to h(g(f(x)))\n\nThe left-hand side is evaluated first, then passed as input to the right-hand side.\nAn argument placeholder exists to direct the input from left into the right side function. - x %&gt;% f(y, .) is equivalent to f(y, x) - x %&gt;% f(y, z = .) is equivalent to f(y, z = x)\nKeyboard Shortcut: Type CMD + Shift + M (Mac) or CTRL + Shift + M (Win) to make pipes (%&gt;%) easily\n\nsum(snp_data$chr)\n\n[1] 12\n\n# is equivalent to\nsnp_data$chr %&gt;% sum(.)\n\n[1] 12\n\n# or\nsnp_data$chr %&gt;% sum # for shortest\n\n[1] 12\n\n\nNow let‚Äôs add dplyr (https://dplyr.tidyverse.org/) ‚Äúa grammar of data manipulation‚Äù.\n\nCheatsheet: https://biostats.w.uib.no/dplyr-a-simplified-cheat-sheet/\nmutate() adds new variables that are functions of existing variables\nselect() picks variables based on their names.\nfilter() picks cases based on their values.\nsummarise() reduces multiple values down to a single summary.\narrange() changes the ordering of the rows.\n\nLet‚Äôs use just filter() and select() now.\n\n# Filter for subsetting the rows of a data.frame\nsnp_data %&gt;% \n  filter(chr==1,\n         pos&lt;100)\n# Select to subset the columns and/or reorder them\nsnp_data %&gt;% \n  select(chr,pos,ind2:ind3)\n\n# Combo \nsnp_data %&gt;% \n  # pick out chromosome 2 only\n  filter(chr==2) %&gt;% \n  # select desired colulmns\n  select(chr,pos) %&gt;% \n  # grab a single column\n  .$pos %&gt;% \n  # pass it to a function like summary\n  summary",
    "crumbs": [
      "Module 1",
      "Reproducible Projects in R"
    ]
  },
  {
    "objectID": "lessons/1_Quarto.html#addsubtractarithmetic",
    "href": "lessons/1_Quarto.html#addsubtractarithmetic",
    "title": "Reproducible Projects in R",
    "section": "Add/Subtract/Arithmetic",
    "text": "Add/Subtract/Arithmetic\n\n\n\n\n\n\nFigure¬†2: Element-wise operations ‚Äì figure from https://www.dataquest.io/\n\n\n\n\n4+4 # sum\n3/3 # divide\nlog(10) # natural logarithm\nlog10(0.01) # base-10 logarithm\nexp(2.3) # exponential\n\n# Summary statistics\ntmp = c(1,2,3) # example\nmean(tmp) # mean\nvar(tmp) # variance\nsum(tmp) # sum\n\n# Summary statistic in data frame\nmean(snp_data$pos) # mean of a col in the data frame\nvar(snp_data$pos) # var of a col in the data frame\n\n# Example from https://www.dataquest.io/\nexam_grades &lt;- c(92, 90, 84, 95, 77, 92, 85)\nhomework_grades &lt;- c(87, 81, 95, 86, 85, 90, 88)\nsum_grades = exam_grades+ homework_grades\n\nRecall:\n\\[\ny = X\\beta + \\epsilon\n\\]",
    "crumbs": [
      "Module 1",
      "Reproducible Projects in R"
    ]
  },
  {
    "objectID": "lessons/1_Quarto.html#matrix-multiplication",
    "href": "lessons/1_Quarto.html#matrix-multiplication",
    "title": "Reproducible Projects in R",
    "section": "Matrix multiplication",
    "text": "Matrix multiplication\n\nbeta &lt;- c(10, 2)\n\n# Matrix multiplication\nX %*% beta\n\n     [,1]\n[1,]   10\n[2,]   12\n[3,]   10\n\nbeta * beta\n\n[1] 100   4\n\nbeta %*% beta\n\n     [,1]\n[1,]  104\n\n\nCross products and transpose\n\nt(X) %*% X\n\n     [,1] [,2]\n[1,]    3    1\n[2,]    1    1\n\nt(X) %*% c(10, 12, 11)\n\n     [,1]\n[1,]   33\n[2,]   12\n\n\nInversion\nRecall that \\(A^{-1}A=AA^{-1}=1\\) defines an inverse matrix\n\nA&lt;-t(X) %*% X # make a square matrix\nA\n\n     [,1] [,2]\n[1,]    3    1\n[2,]    1    1\n\n\n\n# Invert it\nAinv&lt;-solve(A)\nAinv\n\n     [,1] [,2]\n[1,]  0.5 -0.5\n[2,] -0.5  1.5\n\n\n\nA%*%Ainv\n\n             [,1] [,2]\n[1,] 1.000000e+00    0\n[2,] 5.551115e-17    1\n\n\nRecall the OLS solution for a linear model:\n\\[\n\\hat{\\beta} = (X^TX)^{-1}X^Ty\n\\]\n\ny &lt;- c(10, 12, 11)\nsolve(t(X) %*% X) %*% t(X) %*% y\n\n     [,1]\n[1,] 10.5\n[2,]  1.5",
    "crumbs": [
      "Module 1",
      "Reproducible Projects in R"
    ]
  },
  {
    "objectID": "lessons/about.html",
    "href": "lessons/about.html",
    "title": "About",
    "section": "",
    "text": "About this site\n\n1 + 1\n\n[1] 2"
  },
  {
    "objectID": "lessons/2_LinearModels.html#toy-model",
    "href": "lessons/2_LinearModels.html#toy-model",
    "title": "Linear Models with Matrices",
    "section": "Toy model¬†",
    "text": "Toy model",
    "crumbs": [
      "Module 1",
      "Linear Models with Matrices"
    ]
  },
  {
    "objectID": "lessons/2_LinearModels.html#real-data-model",
    "href": "lessons/2_LinearModels.html#real-data-model",
    "title": "Linear Models with Matrices",
    "section": "Real data model",
    "text": "Real data model",
    "crumbs": [
      "Module 1",
      "Linear Models with Matrices"
    ]
  },
  {
    "objectID": "lessons/2_LinearModels.html#exploratory-data-analysis",
    "href": "lessons/2_LinearModels.html#exploratory-data-analysis",
    "title": "Linear Models with Matrices",
    "section": "Exploratory data analysis",
    "text": "Exploratory data analysis\n\nLater, we‚Äôll take some time. Practice using R, especially dplyr and related tidyverse functions to summarize and get to know the dataset.\n\n\nTransforming data\npivot_wider() pivot_longer() group_by() + nest()\n\n\nAnalyzing multiple traits\npurrr()\nFunctions?\n\n\nSummary statistics\n\n\nTrait distributions",
    "crumbs": [
      "Module 1",
      "Linear Models with Matrices"
    ]
  },
  {
    "objectID": "lessons/2_LinearModels.html#anova",
    "href": "lessons/2_LinearModels.html#anova",
    "title": "Linear Models with Matrices",
    "section": "ANOVA",
    "text": "ANOVA\nTwo parts of Analysis of Variance\n\nCompute means\nCompute deviations (sums of squares, mean squares)\n\n\n\n\n\n\n\nFigure¬†2: Computing means and sums of squares for ANOVA\n\n\n\nAnd we can write the classical ANOVA table. Variance is partitioned into two components: Among Groups and Within Groups.\n\n\n\n\n\n\n\n\n\n\nSource of Variation\nDegrees of Freedom (DF)\nSum of Squares (SS)\nMean Square (MS)\nF-value\n\n\n\n\nAmong Groups\n\\(\\alpha‚àí1\\)\n\\(SS_A=\\sum_{i=1}^{\\alpha} n_i ( \\bar{y_i.} - \\bar{y..})^2\\)\n$\n\n\n\n\nMS_A = $ | ùêπ=\\frac{MS_A}{MS_E} | | Within Groups | \\(ùëÅ‚àí\\alpha\\) | $ SS_E = {i=1}^{j=1}^{n_i} (y_{ij} - {y_i.})^2 $ | $ MS_E = \\frac{SS_E}{N- $ | | | Total | \\(ùëÅ‚àí1\\) | $ SS_T = {i=1}^{j=1}^{n_i} (y_{ij} - {y_{..}})^2 $ | | |\nQuestion:",
    "crumbs": [
      "Module 1",
      "Linear Models with Matrices"
    ]
  },
  {
    "objectID": "lessons/2_LinearModels.html#anova-with-lm",
    "href": "lessons/2_LinearModels.html#anova-with-lm",
    "title": "Linear Models with Matrices",
    "section": "ANOVA with lm()",
    "text": "ANOVA with lm()\nTwo parts of Analysis of Variance\n\nCompute means\nCompute deviations (sums of squares, mean squares)\n\n\n\n\n\n\n\nFigure¬†2: Computing means and sums of squares for ANOVA\n\n\n\nAnd we can write the classical ANOVA table. Variance is partitioned into two components: Among Groups and Within Groups.\n\n\n\n\n\n\n\n\n\n\nSource of Variation\nDegrees of Freedom (DF)\nSum of Squares (SS)\nMean Square (MS)\nF-value\n\n\n\n\nAmong Groups\n\\(\\alpha‚àí1\\)\n\\(SS_A=\\sum_{i=1}^{\\alpha} n_i ( \\bar{y_i\\cdot} - \\bar{y\\cdot\\cdot})^2\\)\n\\(MS_A = \\frac{SS_A}{\\alpha-1}\\)\n\\(ùêπ=\\frac{MS_A}{MS_E}\\)\n\n\nWithin Groups\n\\(ùëÅ‚àí\\alpha\\)\n\\(SS_E = \\sum_{i=1}^\\alpha \\sum_{j=1}^{n_i} (y_{ij} - \\bar{y_i\\cdot})^2\\)\n\\(MS_E = \\frac{SS_E}{N-\\alpha}\\)\n\n\n\nTotal\n\\(ùëÅ‚àí1\\)\n\\(SS_T = \\sum_{i=1}^\\alpha \\sum_{j=1}^{n_i} (y_{ij} - \\bar{y_{\\cdot\\cdot}})^2\\)\n\n\n\n\n\nWhere:\n\n\\(\\alpha\\) = number of groups\n\\(n\\) = number of observations in group ùëñ\n\\(N\\) = total number of observations\n\\(\\bar{y_{i\\cdot}}\\) = mean of group ùëñ\n\\(\\bar{y_{\\cdot\\cdot}}\\) = grand mean\n\nOur goal is to partition tot. variance into sources.\nWe compare the variance among groups (e.g.¬†among genotypes) to the residual variance using a ratio of variances (the F-value).\nBasically, the F-test is looking for greater signal compared to noise. A high F-value means among groups &gt; residual and so group variance is probably important.\n\nlibrary(tidyverse)\n\n\n# Create an example\ndf &lt;- data.frame(Replicate = 1:4,\n                 GenoA = c(14, 17, 15, 15),\n                 GenoB = c(11, 13, 10, 12)) \ndf &lt;- df %&gt;% \n  # this will change the \"wide\" data frame to a \"long\" one\n  ## it stacks the values of GenoA and GenoB into a column labelled \"Biomass\"\n  ## and the col headers go to a new column \"Genotype\"\n  pivot_longer(cols = c(GenoA, GenoB),\n               names_to = \"Genotype\",\n               values_to = \"Biomass\") %&gt;% \n  # Make genotype and replicate into factors\n    mutate(Genotype=as.factor(Genotype),\n           # Replicate needs to be a factor-type\n           # because it should be treated as a categorical NOT a numerical variable\n           ### Replicate 4 doesn't come after Replicate 3 in any logical way.\n           Replicate=as.factor(Replicate))\n\n\nfit.lm &lt;- lm(Biomass ~ Genotype, data = df)\nsummary(fit.lm)\n\n\nCall:\nlm(formula = Biomass ~ Genotype, data = df)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-1.5000 -0.6875 -0.2500  0.7500  1.7500 \n\nCoefficients:\n              Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)    15.2500     0.6374   23.93  3.5e-07 ***\nGenotypeGenoB  -3.7500     0.9014   -4.16  0.00594 ** \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 1.275 on 6 degrees of freedom\nMultiple R-squared:  0.7426,    Adjusted R-squared:  0.6997 \nF-statistic: 17.31 on 1 and 6 DF,  p-value: 0.005943\n\n\n\nfit.aov&lt;-aov(Biomass ~ Genotype, data = df)\nsummary(fit.aov)\n\n            Df Sum Sq Mean Sq F value  Pr(&gt;F)   \nGenotype     1  28.12  28.125   17.31 0.00594 **\nResiduals    6   9.75   1.625                   \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\n\nt.test(Biomass~Genotype,data = df)\n\n\n    Welch Two Sample t-test\n\ndata:  Biomass by Genotype\nt = 4.1603, df = 5.9961, p-value = 0.005951\nalternative hypothesis: true difference in means between group GenoA and group GenoB is not equal to 0\n95 percent confidence interval:\n 1.544032 5.955968\nsample estimates:\nmean in group GenoA mean in group GenoB \n              15.25               11.50 \n\n\nNotice the way the coefficients are reported from lm().\nIt shows only an effect for (Intercept) and GenotypeGenoB.\nInitially, we wrote the model as\n\\[\ny_{ij} = \\mu + \\tau_i + \\epsilon_{ij}\n\\]\n\\(i\\) genotypes (1,2), \\(j\\) replications (1,2,3,4)\nSo our matrices and vectors looked like this:\n\\[\n\\begin{bmatrix}\ny_{11} \\\\\ny_{12} \\\\\ny_{13} \\\\\ny_{14} \\\\\ny_{21} \\\\\ny_{22} \\\\\ny_{23} \\\\\ny_{24}\n\\end{bmatrix} =\n\\begin{bmatrix}\n1 & 0 & 0 \\\\\n1 & 1 & 0 \\\\\n1 & 1 & 0 \\\\\n1 & 1 & 0 \\\\\n1 & 0 & 1 \\\\\n1 & 0 & 1 \\\\\n1 & 0 & 1 \\\\\n1 & 0 & 1\n\\end{bmatrix}\n\\begin{bmatrix}\n\\mu \\\\\n\\tau_1 \\\\\n\\tau_2\n\\end{bmatrix} +\n\\begin{bmatrix}\n\\epsilon_{11} \\\\\n\\epsilon_{12} \\\\\n\\epsilon_{13} \\\\\n\\epsilon_{14} \\\\\n\\epsilon_{21} \\\\\n\\epsilon_{22} \\\\\n\\epsilon_{23} \\\\\n\\epsilon_{24}\n\\end{bmatrix}\n\\]\nThis specification implies 3 coefficients would be estimated (\\(\\mu\\), \\(\\tau_1\\) and \\(\\tau_2\\)).",
    "crumbs": [
      "Module 1",
      "Linear Models with Matrices"
    ]
  },
  {
    "objectID": "lessons/2_LinearModels.html#parameter-estimation-with-ols",
    "href": "lessons/2_LinearModels.html#parameter-estimation-with-ols",
    "title": "Linear Models with Matrices",
    "section": "Parameter estimation with OLS",
    "text": "Parameter estimation with OLS\nTo see why the difference, let‚Äôs first calculate the OLS solution ‚Äúby hand‚Äù\nRecall from class that linear models with fixed-effects and simple residuals can be solved with a closed form approach that minimizes the residual sum of squares (RSS). This is called the ‚ÄúOrdinary Least Squares‚Äù solution (OLS).\n\\[\n\\hat{\\beta} = (X'X)^{-1}X'y\n\\]\n\ndf\n\n# A tibble: 8 √ó 3\n  Replicate Genotype Biomass\n  &lt;fct&gt;     &lt;fct&gt;      &lt;dbl&gt;\n1 1         GenoA         14\n2 1         GenoB         11\n3 2         GenoA         17\n4 2         GenoB         13\n5 3         GenoA         15\n6 3         GenoB         10\n7 4         GenoA         15\n8 4         GenoB         12\n\n\n\ny&lt;-df$Biomass\n\n# Because R is too smart, we'll have to make the X matrix shown above for a demo\n\nX&lt;-matrix(c(1,1,1,1,1,1,1,1,\n            1,0,1,0,1,0,1,0,\n            0,1,0,1,0,1,0,1),\n          ncol=3)\nX\n\n     [,1] [,2] [,3]\n[1,]    1    1    0\n[2,]    1    0    1\n[3,]    1    1    0\n[4,]    1    0    1\n[5,]    1    1    0\n[6,]    1    0    1\n[7,]    1    1    0\n[8,]    1    0    1\n\n\nR provides a function called model.matrix() for constructing design matrices. What model.matrix() does, is what lm() and other software do.\n\nX1&lt;-model.matrix(Biomass~Genotype,data = df)\nX1\n\n  (Intercept) GenotypeGenoB\n1           1             0\n2           1             1\n3           1             0\n4           1             1\n5           1             0\n6           1             1\n7           1             0\n8           1             1\nattr(,\"assign\")\n[1] 0 1\nattr(,\"contrasts\")\nattr(,\"contrasts\")$Genotype\n[1] \"contr.treatment\"\n\n\n\nXtX&lt;-t(X)%*%X\nXty&lt;-t(X)%*%y\nbeta_hat&lt;-solve(XtX)%*%Xty\n\nError in solve.default(XtX): Lapack routine dgesv: system is exactly singular: U[3,3] = 0\n\n\nSingular = a square matrix that is not invertible\nA related term is ‚ÄúRank‚Äù which refers to the number of linearly independent columns of a matrix.\n\n# What is the \"rank\" of XtX? Want it to be 3.\nqr(XtX)$rank\n\n[1] 2\n\n\nThe XtX matrix is not ‚Äúfull rank‚Äù because columns 2 and 3 are numerical mirrors.\nThere aren‚Äôt enough degrees of freedom to express it this way.\nIn R, functions like lm() will automatically constrain the model by contrasting levels against a reference (the first level of the factor).\nSo \\(\\tau_1 = 0\\) and \\(\\tau_2=1\\).\n\\[\n\\begin{bmatrix}\ny_{11} \\\\\ny_{12} \\\\\ny_{13} \\\\\ny_{14} \\\\\ny_{21} \\\\\ny_{22} \\\\\ny_{23} \\\\\ny_{24}\n\\end{bmatrix} =\n\\begin{bmatrix}\n1 & 0 \\\\\n1 & 0 \\\\\n1 & 0 \\\\\n1 & 0 \\\\\n1 & 1 \\\\\n1 & 1 \\\\\n1 & 1 \\\\\n1 & 1\n\\end{bmatrix}\n\\begin{bmatrix}\n\\mu \\\\\n\\tau_2\n\\end{bmatrix} +\n\\begin{bmatrix}\n\\epsilon_{11} \\\\\n\\epsilon_{12} \\\\\n\\epsilon_{13} \\\\\n\\epsilon_{14} \\\\\n\\epsilon_{21} \\\\\n\\epsilon_{22} \\\\\n\\epsilon_{23} \\\\\n\\epsilon_{24}\n\\end{bmatrix}\n\\]\n\nbeta_hat&lt;-solve(t(X1)%*%X1)%*%(t(X1)%*%y)\nbeta_hat\n\n               [,1]\n(Intercept)   15.25\nGenotypeGenoB -3.75\n\n\n\nfit.lm$coefficients\n\n  (Intercept) GenotypeGenoB \n        15.25         -3.75 \n\n\nTa da! üéâ",
    "crumbs": [
      "Module 1",
      "Linear Models with Matrices"
    ]
  },
  {
    "objectID": "lessons/2_LinearModels.html#check-assumptions",
    "href": "lessons/2_LinearModels.html#check-assumptions",
    "title": "Linear Models with Matrices",
    "section": "Check assumptions",
    "text": "Check assumptions\n\nplot(fit.lm)",
    "crumbs": [
      "Module 1",
      "Linear Models with Matrices"
    ]
  },
  {
    "objectID": "lessons/2_LinearModels.html#estimated-marginal-means",
    "href": "lessons/2_LinearModels.html#estimated-marginal-means",
    "title": "Linear Models with Matrices",
    "section": "Estimated marginal means",
    "text": "Estimated marginal means\nOur goal is often to compare the mean of different treatment groups, for example different genotypes.\nYou may have encountered ‚Äúlsmeans‚Äù or ‚Äúemmeans‚Äù in the literature? Or if you use SAS.\nLeast squares means (LSMeans)‚Äînow more commonly called estimated marginal means (EMMs)‚Äîare model-based estimates of factor level means derived from a fitted linear model (LM). They are related to the ‚Äúbest linear unbiased estimators‚Äù (BLUEs) in a linear mixed model; we‚Äôll get to all that later.\n\nlibrary(emmeans)\n\nWelcome to emmeans.\nCaution: You lose important information if you filter this package's results.\nSee '? untidy'\n\nemmeans(fit.lm,\"Genotype\")\n\n Genotype emmean    SE df lower.CL upper.CL\n GenoA      15.2 0.637  6    13.69     16.8\n GenoB      11.5 0.637  6     9.94     13.1\n\nConfidence level used: 0.95 \n\n\nEMMs are not arithmetic means. They are predicted means from the fitted model. If there were additional factors in our model, they would evaluate our ‚ÄúGenotypes‚Äù averaging over the other factors/covariates.\nLook at how they are related to the coefficients from the OLS model.\n\nsummary(fit.lm)\n\n\nCall:\nlm(formula = Biomass ~ Genotype, data = df)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-1.5000 -0.6875 -0.2500  0.7500  1.7500 \n\nCoefficients:\n              Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)    15.2500     0.6374   23.93  3.5e-07 ***\nGenotypeGenoB  -3.7500     0.9014   -4.16  0.00594 ** \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 1.275 on 6 degrees of freedom\nMultiple R-squared:  0.7426,    Adjusted R-squared:  0.6997 \nF-statistic: 17.31 on 1 and 6 DF,  p-value: 0.005943",
    "crumbs": [
      "Module 1",
      "Linear Models with Matrices"
    ]
  },
  {
    "objectID": "lessons/2_LinearModels.html#some-real-data",
    "href": "lessons/2_LinearModels.html#some-real-data",
    "title": "Linear Models with Matrices",
    "section": "Some real data",
    "text": "Some real data\nDownload the CCB Crimson Clover ALT dataset from Canvas.\nPut it in the data/ sub-directory of your project.\n\nlibrary(tidyverse)\n\nImport the dataset\n\nalt&lt;-read.csv(here::here(\"data\",\"19-25CC_ALT_DATA_ALL_2025-08-23.csv\"))\n\nstr(alt)\n\n'data.frame':   3058 obs. of  16 variables:\n $ X               : int  1 2 3 4 5 6 7 8 9 10 ...\n $ site            : chr  \"AL\" \"AL\" \"AL\" \"AL\" ...\n $ year            : int  24 24 24 24 24 24 24 24 24 24 ...\n $ site.year       : chr  \"24AL\" \"24AL\" \"24AL\" \"24AL\" ...\n $ unique.id       : chr  \"24ALCC_ALT-01-01\" \"24ALCC_ALT-01-02\" \"24ALCC_ALT-01-03\" \"24ALCC_ALT-02-01\" ...\n $ entry           : chr  \"Aldo\" \"21NCCCLH\" \"23MDCC\" \"21NCCCE\" ...\n $ rep             : int  1 1 1 1 1 1 1 1 1 1 ...\n $ row             : int  1 2 3 1 2 3 1 2 3 1 ...\n $ range           : int  1 1 1 2 2 2 3 3 3 4 ...\n $ biomass.1       : num  56.3 46.4 55.8 79.8 60.4 ...\n $ growth.stage.1  : num  9 7 7 9 8 8 9 9 8 7 ...\n $ fallstandcount  : int  NA NA NA NA NA NA NA NA NA NA ...\n $ springstandcount: int  95 95 95 95 95 75 75 95 75 95 ...\n $ fall.vigor.av   : num  5 5 5 5 5 9 5 5 9 5 ...\n $ spring.vigor.av : num  9 5 5 9 5 5 5 5 5 5 ...\n $ wintersurvival  : num  NA NA NA NA NA NA NA NA NA NA ...\n\n\n\nalt %&gt;% head\n\n  X site year site.year        unique.id         entry rep row range biomass.1\n1 1   AL   24      24AL 24ALCC_ALT-01-01          Aldo   1   1     1  56.33333\n2 2   AL   24      24AL 24ALCC_ALT-01-02      21NCCCLH   1   2     1  46.41667\n3 3   AL   24      24AL 24ALCC_ALT-01-03        23MDCC   1   3     1  55.75000\n4 4   AL   24      24AL 24ALCC_ALT-02-01       21NCCCE   1   1     2  79.75000\n5 5   AL   24      24AL 24ALCC_ALT-02-02 23NCCCE Elite   1   2     2  60.41667\n6 6   AL   24      24AL 24ALCC_ALT-02-03         Dixie   1   3     2  57.16667\n  growth.stage.1 fallstandcount springstandcount fall.vigor.av spring.vigor.av\n1              9             NA               95             5               9\n2              7             NA               95             5               5\n3              7             NA               95             5               5\n4              9             NA               95             5               9\n5              8             NA               95             5               5\n6              8             NA               75             9               5\n  wintersurvival\n1             NA\n2             NA\n3             NA\n4             NA\n5             NA\n6             NA\n\n\nAbout\nThe CCBN ‚ÄúAdvanced Line Trial‚Äù (ALT) for Crimson Clover (Trifolium incarnatum) is a competitive variety trial. New ‚Äúadvanced line‚Äù bulks, created from top plants in CCBN nurseries, are compared against current best lines from other programs/years and commercial checks at up to 15 locations. Trials are conducted in randomized complete block designs with 15‚Äô single-row plots flanked by triticale for competition; they assess biomass, vigor, winter survival, seed yield.\n\n\n\n\n\n\nFigure¬†3: Map of Cover Crop Breeding Network Testing Sites\n\n\n\n\n\n\n\n\n\nFigure¬†4: Example of a CCB ALT Layout - 24ALCC_ALT\n\n\n\n\nsite: State Location Code\nyear: Year HARVESTED (trials are planted in Fall, harvested Spring of following year)\nsite.year: site-year combination\nunique.id: unique plot ID\nentry: Crimson Clover variety name.\nrep: integer - specifies a complete block within a given site.year\nrow: Corresponds to one full planter pass. I‚Äôd prefer these to be called columns to match matrix conventions (row ‚Äì by - column). But that‚Äôs how CCB records it (see Figure¬†4).\nrange: Spanning a plot in the direct the planter drives. In matrix convention, this would be called the row ü§¶ (see Figure¬†4).\nbiomass.1: plot dry mass in grams-per-linear-foot-harvested\ngrowth.stage.1: Khalu & Fick growth stage at time of harvest\nfall/springstandcount: percent of plot out of 100 with living plants, before/after winter.\nfall/spring.vigor.av: visual rating of plot vigor scored on a time-specific 1-9 scale (i.e.¬†1 = worst, 5 = average, 9 = best).\nwintersurvival: spring / fall standcount.",
    "crumbs": [
      "Module 1",
      "Linear Models with Matrices"
    ]
  },
  {
    "objectID": "lessons/2_LinearModels.html#your-task",
    "href": "lessons/2_LinearModels.html#your-task",
    "title": "Linear Models with Matrices",
    "section": "Your task",
    "text": "Your task\n\nFind a balanced chunk of the data.\nBalance is going to mean a lack of missing data for most or all traits.\nI suggest taking out 2-4 site.years worth.\nSubset the dataset.\nPick a trait and follow the steps we did above.\nStart simple with your modelling.\n\nQuestions:\n\nWhat are the potential sources of variation in the data? Write the model.\nWhat sources of variation are significant contributors to the model fit?\nWhich are the ‚Äúbest‚Äùperforming Crimson Clovers?",
    "crumbs": [
      "Module 1",
      "Linear Models with Matrices"
    ]
  },
  {
    "objectID": "lessons/2_LinearModels.html#subset-the-data",
    "href": "lessons/2_LinearModels.html#subset-the-data",
    "title": "Linear Models with Matrices",
    "section": "Subset the data",
    "text": "Subset the data\nThen I‚Äôll introduce a real dataset, give you a hint how to subset it, and turn you loose to analyze it yourself.\nSteps we‚Äôll do:\n\nPose a question\nWrite the model\nEstimate parameters with OLS\n\nSolve ‚Äúby hand‚Äù in R\nUsing the lm() function\n\nPartition variability: ANOVA\nHypothesis testing: F-test, t-test - is the effect and/or the variance ‚Äúsignificant‚Äù?",
    "crumbs": [
      "Module 1",
      "Linear Models with Matrices"
    ]
  }
]